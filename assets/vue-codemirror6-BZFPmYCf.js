import{z as e,E as t,o as a,A as l,C as o,B as n,D as i,F as s,G as r,H as u,S as d,I as c,J as p}from"./@codemirror-CxghDZKK.js";import{b as v,m as f}from"./codemirror-CQYd4IMm.js";import{d as m,r as g,s as h,k as y,i as S,h as b,n as w,C,a8 as B}from"./@vue-BkTsjJrn.js";
/**
 * vue-codemirror6
 *
 * @description CodeMirror6 Component for vue2 and vue3.
 * @author Logue <logue@hotmail.co.jp>
 * @copyright 2022-2025 By Masashi Yoshikawa All rights reserved.
 * @license MIT
 * @version 1.3.12
 * @see {@link https://github.com/logue/vue-codemirror6}
 */function j(e,t={},a){const{props:l,domProps:o,on:n,...i}=t,s=n?(e=>e?Object.entries(e).reduce(((e,[t,a])=>(t=`on${t=t.charAt(0).toUpperCase()+t.slice(1)}`,{...e,[t]:a})),{}):{})(n):{};return B(e,{...i,...l,...o,...s},a)}var O=m({name:"CodeMirror",model:{prop:"modelValue",event:"update:modelValue"},props:{modelValue:{type:String,default:""},theme:{type:Object,default:()=>({})},dark:{type:Boolean,default:!1},basic:{type:Boolean,default:!1},minimal:{type:Boolean,default:!1},placeholder:{type:String,default:void 0},wrap:{type:Boolean,default:!1},tab:{type:Boolean,default:!1},indentUnit:{type:String,default:void 0},allowMultipleSelections:{type:Boolean,default:!1},tabSize:{type:Number,default:void 0},lineSeparator:{type:String,default:void 0},readonly:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},extensions:{type:Array,default:()=>[]},phrases:{type:Object,default:()=>{}},lang:{type:Object,default:()=>{}},linter:{type:Function,default:void 0},linterConfig:{type:Object,default:()=>({})},forceLinting:{type:Boolean,default:!1},gutter:{type:Boolean,default:!1},gutterConfig:{type:Object,default:()=>{}},tag:{type:String,default:"div"},scrollIntoView:{type:Boolean,default:!0}},emits:{"update:modelValue":(e="")=>!0,update:e=>!0,ready:e=>!0,focus:e=>!0,change:e=>!0,destroy:()=>!0},setup(m,B){const j=g(),O=g(m.modelValue),V=h(new e),x=y({get:()=>V.value.hasFocus,set:e=>{e&&V.value.focus()}}),M=y({get:()=>V.value.state.selection,set:e=>V.value.dispatch({selection:e})}),N=y({get:()=>V.value.state.selection.main.head,set:e=>V.value.dispatch({selection:{anchor:e}})}),z=y({get:()=>V.value.state.toJSON(),set:e=>V.value.setState(t.fromJSON(e))}),D=g(0),L=g(0),k=y((()=>{const d=new o,c=new o;if(m.basic&&m.minimal)throw"[Vue CodeMirror] Both basic and minimal cannot be specified.";return[m.basic&&!m.minimal?v:void 0,m.minimal&&!m.basic?f:void 0,e.updateListener.of((e=>{var t;B.emit("focus",V.value.hasFocus),D.value=null==(t=V.value.state.doc)?void 0:t.length,!e.changes.empty&&e.docChanged&&(m.linter&&(m.forceLinting&&r(V.value),L.value=m.linter(V.value).length),B.emit("update",e))})),e.theme(m.theme,{dark:m.dark}),m.wrap?e.lineWrapping:void 0,m.tab?a.of([u]):void 0,m.indentUnit?l.of(m.indentUnit):void 0,t.allowMultipleSelections.of(m.allowMultipleSelections),m.tabSize?c.of(t.tabSize.of(m.tabSize)):void 0,m.phrases?t.phrases.of(m.phrases):void 0,t.readOnly.of(m.readonly),e.editable.of(!m.disabled),m.lineSeparator?t.lineSeparator.of(m.lineSeparator):void 0,m.lang?d.of(m.lang):void 0,m.linter?n(m.linter,m.linterConfig):void 0,m.linter&&m.gutter?i(m.gutterConfig):void 0,m.placeholder?s(m.placeholder):void 0,...m.extensions].filter((e=>!!e))}));S(k,(e=>{var t;null==(t=V.value)||t.dispatch({effects:d.reconfigure.of(e)})}),{immediate:!0}),S((()=>m.modelValue),(async e=>{if(V.value.composing||V.value.state.doc.toJSON().join(m.lineSeparator??"\n")===e)return;const t=!V.value.state.selection.ranges.every((t=>t.anchor<e.length&&t.head<e.length));V.value.dispatch({changes:{from:0,to:V.value.state.doc.length,insert:e},selection:t?{anchor:0,head:0}:V.value.state.selection,scrollIntoView:m.scrollIntoView})}),{immediate:!0}),b((async()=>{let a=O.value;j.value&&(j.value.childNodes[0]&&(O.value,a=j.value.childNodes[0].innerText.trim()),V.value=new e({parent:j.value,state:t.create({doc:a,extensions:k.value}),dispatch:e=>{V.value.update([e]),!e.changes.empty&&e.docChanged&&(B.emit("update:modelValue",e.state.doc.toString()??""),B.emit("change",e.state))}}),await w(),B.emit("ready",{view:V.value,state:V.value.state,container:j.value}))})),C((()=>{V.value.destroy(),B.emit("destroy")}));const F={editor:j,view:V,cursor:N,selection:M,focus:x,length:D,json:z,diagnosticCount:L,dom:V.value.contentDOM,lint:()=>{!m.linter||!V.value||(m.forceLinting&&r(V.value),L.value=c(V.value.state))},forceReconfigure:()=>{var e,t;null==(e=V.value)||e.dispatch({effects:d.reconfigure.of([])}),null==(t=V.value)||t.dispatch({effects:d.appendConfig.of(k.value)})},getRange:(e,t)=>V.value.state.sliceDoc(e,t),getLine:e=>V.value.state.doc.line(e+1).text,lineCount:()=>V.value.state.doc.lines,getCursor:()=>V.value.state.selection.main.head,listSelections:()=>{let e;return null!==(e=V.value.state.selection.ranges)&&void 0!==e?e:[]},getSelection:()=>{let e;return null!==(e=V.value.state.sliceDoc(V.value.state.selection.main.from,V.value.state.selection.main.to))&&void 0!==e?e:""},getSelections:()=>{const e=V.value.state;return e?e.selection.ranges.map((t=>e.sliceDoc(t.from,t.to))):[]},somethingSelected:()=>V.value.state.selection.ranges.some((e=>!e.empty)),replaceRange:(e,t,a)=>V.value.dispatch({changes:{from:t,to:a,insert:e}}),replaceSelection:e=>V.value.dispatch(V.value.state.replaceSelection(e)),setCursor:e=>V.value.dispatch({selection:{anchor:e}}),setSelection:(e,t)=>V.value.dispatch({selection:{anchor:e,head:t}}),setSelections:(e,t)=>V.value.dispatch({selection:p.create(e,t)}),extendSelectionsBy:e=>V.value.dispatch({selection:p.create(M.value.ranges.map((t=>t.extend(e(t)))))})};return B.expose(F),F},render(){return j(this.$props.tag,{ref:"editor",class:"vue-codemirror"},this.$slots.default?j("aside",{style:"display: none;","aria-hidden":"true"},"function"==typeof(e=this.$slots.default)?e():e):void 0);var e}});export{O as o};
